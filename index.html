<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sadaf Battle Hub Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --neon: #00f2ff; --bg: #050505; --card: #111; --x-color: #ff0055; --gold: #ffcc00; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; overflow: hidden; }
        
        h1 { color: var(--neon); text-shadow: 0 0 15px var(--neon); margin: 5px 0; font-size: 1.8rem; text-transform: uppercase; }
        .stats { display: flex; gap: 15px; font-size: 0.9rem; color: #ccc; margin-bottom: 10px; }

        /* Level Selection Styles from Screenshot */
        .level-selector { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 300px; margin-bottom: 15px; }
        .lvl-btn { padding: 10px; border: 2px solid #333; background: transparent; color: white; border-radius: 30px; cursor: pointer; font-weight: bold; font-size: 0.8rem; transition: 0.3s; }
        .lvl-btn.active { background: var(--neon); color: black; border-color: var(--neon); box-shadow: 0 0 15px var(--neon); }
        .lvl-btn.pvp-btn { border-color: var(--gold); color: var(--gold); }
        .lvl-btn.pvp-btn.active { background: var(--gold); color: black; }

        .timer { font-size: 1.5rem; color: var(--x-color); font-weight: bold; margin-bottom: 5px; }

        /* 5x5 Grid Styles */
        .grid-container { padding: 8px; border: 3px solid var(--neon); border-radius: 15px; background: #000; box-shadow: 0 0 20px rgba(0, 242, 255, 0.2); }
        .grid { display: grid; grid-template-columns: repeat(5, 55px); grid-template-rows: repeat(5, 55px); gap: 5px; }
        .cell { width: 55px; height: 55px; background: var(--card); border: 1px solid #222; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .cell.O { color: var(--neon); text-shadow: 0 0 10px var(--neon); }
        .cell.X { color: var(--x-color); text-shadow: 0 0 10px var(--x-color); }

        .btn-restart { margin-top: 20px; padding: 10px 40px; background: transparent; border: 2px solid var(--neon); border-radius: 30px; color: var(--neon); font-weight: bold; cursor: pointer; text-transform: uppercase; }
    </style>
</head>
<body>

    <h1>BATTLE HUB üéÆ</h1>
    <div class="stats">
        <span>Streak: <span id="streak">0</span></span>
        <span>Best: <span id="best">0</span></span>
    </div>

    <div class="level-selector">
        <button class="lvl-btn active" onclick="setLevel('easy', this)">Easy AI</button>
        <button class="lvl-btn" onclick="setLevel('normal', this)">Normal AI</button>
        <button class="lvl-btn" onclick="setLevel('hard', this)">Hard AI</button>
        <button class="lvl-btn pvp-btn" onclick="setLevel('pvp', this)">2 Players</button>
    </div>

    <div class="timer" id="timer">20s</div>
    <div id="status" style="margin-bottom:10px;">Player O Turn</div>

    <div class="grid-container">
        <div class="grid" id="board"></div>
    </div>

    <button class="btn-restart" onclick="resetGame()">Restart Game</button>

    <script>
        let board = Array(25).fill(null);
        let gameActive = true;
        let difficulty = 'easy';
        let currentPlayer = 'O';
        let timeLeft = 20;
        let timerId = null;

        function setLevel(lvl, btn) {
            difficulty = lvl;
            document.querySelectorAll('.lvl-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            resetGame();
        }

        function startTimer() {
            clearInterval(timerId);
            timeLeft = 20;
            document.getElementById('timer').innerText = timeLeft + "s";
            timerId = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft + "s";
                if(timeLeft <= 0) {
                    clearInterval(timerId);
                    if(gameActive) {
                        document.getElementById('status').innerText = "Time Out!";
                        gameActive = false;
                    }
                }
            }, 1000);
        }

        function initBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            board = Array(25).fill(null);
            for(let i=0; i<25; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.addEventListener('click', () => makeMove(i));
                boardEl.appendChild(cell);
            }
            startTimer();
        }

        function makeMove(i) {
            if(board[i] || !gameActive) return;
            board[i] = currentPlayer;
            render();
            
            if(checkWin(board, currentPlayer)) {
                document.getElementById('status').innerText = `Player ${currentPlayer} Wins!`;
                if(currentPlayer === 'O') confetti();
                gameActive = false;
                clearInterval(timerId);
            } else if(board.every(c => c !== null)) {
                document.getElementById('status').innerText = "Draw!";
                gameActive = false;
                clearInterval(timerId);
            } else {
                if(difficulty === 'pvp') {
                    currentPlayer = currentPlayer === 'O' ? 'X' : 'O';
                    document.getElementById('status').innerText = `Player ${currentPlayer} Turn`;
                    startTimer();
                } else {
                    document.getElementById('status').innerText = "AI Thinking...";
                    clearInterval(timerId);
                    setTimeout(aiMove, 600);
                }
            }
        }

        function aiMove() {
            let move = null;
            // Super Hard Logic: Block user or Win
            if(difficulty === 'hard') {
                move = findBestMove('X') || findBestMove('O') || smartPosition();
            } else if(difficulty === 'normal') {
                if(Math.random() > 0.5) move = findBestMove('X') || findBestMove('O');
            }
            
            if(move === null) {
                let available = board.map((v, i) => v === null ? i : null).filter(v => v !== null);
                move = available[Math.floor(Math.random() * available.length)];
            }

            board[move] = 'X';
            render();
            if(checkWin(board, 'X')) {
                document.getElementById('status').innerText = "AI Wins!";
                gameActive = false;
            } else {
                document.getElementById('status').innerText = "Player O Turn";
                startTimer();
            }
        }

        function findBestMove(p) {
            for(let i=0; i<25; i++) {
                if(board[i] === null) {
                    board[i] = p;
                    if(checkWin(board, p)) { board[i] = null; return i; }
                    board[i] = null;
                }
            }
            return null;
        }

        function smartPosition() {
            // ‡ß´x‡ß´ ‡¶ó‡ßç‡¶∞‡¶ø‡¶°‡ßá ‡¶Æ‡¶æ‡¶ù‡¶ñ‡¶æ‡¶®‡ßá‡¶∞ ‡¶ò‡¶∞‡¶ó‡ßÅ‡¶≤‡ßã (‡ßß‡ß®, ‡ß≠, ‡ßÆ, ‡ßß‡ß≠, ‡ßß‡ßÆ) ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£
            const priority = [12, 6, 7, 8, 11, 13, 16, 17, 18];
            for(let p of priority) {
                if(board[p] === null) return p;
            }
            return null;
        }

        function render() {
            const cells = document.querySelectorAll('.cell');
            board.forEach((val, i) => {
                cells[i].innerText = val || "";
                cells[i].className = `cell ${val || ''}`;
            });
        }

        function checkWin(b, p) {
            // ‡ß´x‡ß´ ‡¶ó‡ßç‡¶∞‡¶ø‡¶°‡ßá ‡ß™‡¶ü‡¶ø ‡¶ó‡ßÅ‡¶ü‡¶ø ‡¶Æ‡¶ø‡¶≤‡¶≤‡ßá ‡¶ú‡ßü (Row, Col, Diag)
            for (let i = 0; i < 25; i++) {
                if (b[i] !== p) continue;
                let r = Math.floor(i / 5), c = i % 5;
                if (c <= 1 && b[i+1]===p && b[i+2]===p && b[i+3]===p) return true;
                if (r <= 1 && b[i+5]===p && b[i+10]===p && b[i+15]===p) return true;
                if (r <= 1 && c <= 1 && b[i+6]===p && b[i+12]===p && b[i+18]===p) return true;
                if (r <= 1 && c >= 3 && b[i+4]===p && b[i+8]===p && b[i+12]===p) return true;
            }
            return false;
        }

        function resetGame() {
            gameActive = true;
            currentPlayer = 'O';
            document.getElementById('status').innerText = "Player O Turn";
            initBoard();
        }

        window.onload = initBoard;
    </script>
</body>
</html>
