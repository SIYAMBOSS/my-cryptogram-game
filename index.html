<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sadaf Hub Pro | Final</title>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --blue: #00f2ff; --pink: #ff00ff; --gold: #ffcc00; --bg: #05050a; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: white; font-family: 'Rajdhani', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; }

        /* --- Full Screen Result --- */
        #result-screen {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 50000;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(15px); animation: zoomIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes zoomIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* --- Admin & Layout --- */
        .header { width: 100%; padding: 15px; display: flex; justify-content: space-around; background: rgba(0,0,0,0.8); border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 1000; }
        .coin-box { font-family: 'Orbitron'; color: var(--gold); font-size: 1.2rem; }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; width: 92vw; max-width: 400px; margin: 20px auto; background: rgba(255,255,255,0.02); padding: 10px; border-radius: 20px; border: 1px solid #333; }
        .cell { aspect-ratio: 1; background: rgba(255,255,255,0.05); border: 1px solid #222; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 2rem; cursor: pointer; }
        
        .btn-pro { background: rgba(255,255,255,0.05); border: 1px solid #444; color: white; padding: 10px 15px; border-radius: 10px; font-family: 'Orbitron'; cursor: pointer; font-size: 0.7rem; }
        .btn-pro.active { border-color: var(--blue); color: var(--blue); box-shadow: 0 0 10px var(--blue); }
        .btn-glow { width: 100%; padding: 15px; background: var(--blue); color: black; border: none; border-radius: 15px; font-family: 'Orbitron'; font-weight: 900; margin-top: 10px; cursor: pointer; }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; padding: 20px; }
        .modal-content { background: #0a0a0f; border: 1px solid var(--blue); padding: 30px; border-radius: 30px; width: 100%; max-width: 400px; text-align: center; }
        
        input { width: 100%; padding: 12px; background: #000; border: 1px solid #333; color: white; border-radius: 10px; margin-bottom: 10px; text-align: center; }
    </style>
</head>
<body>

    <div class="header">
        <div class="coin-box">ü™ô <span id="balance">0</span></div>
        <div id="u-name" style="font-family:'Orbitron'; color:var(--blue); font-size:0.7rem">PLAYER</div>
        <button id="boss-ui" class="btn-pro" style="display:none; color:red; border-color:red" onclick="openM('admin-m')">BOSS</button>
    </div>

    <div id="result-screen">
        <div id="res-icon" style="font-size: 6rem; margin-bottom: 20px;">üèÜ</div>
        <h1 id="res-title" style="font-family:'Orbitron'; font-size: 3.5rem; margin: 0; letter-spacing: 5px;">VICTORY</h1>
        <p id="res-msg" style="font-size: 1.5rem; color: var(--gold); margin: 10px 0 30px 0;">+500 COINS</p>
        <button class="btn-glow" style="width: 250px; background: white;" onclick="closeResult()">PLAY AGAIN</button>
    </div>

    <div style="padding: 20px; text-align: center;">
        <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">
            <button id="easy" class="btn-pro active" onclick="setMode('easy')">EASY</button>
            <button id="hard" class="btn-pro" onclick="setMode('hard')">HARD</button>
            <button id="2p" class="btn-pro" onclick="setMode('2p')">2 PLAYER</button>
        </div>
        <div style="font-family:'Orbitron'; font-size:0.8rem">
            BET: <input type="number" id="bet" value="100" style="width:70px; background:none; border:none; border-bottom:1px solid #555; color:var(--gold); text-align:center;">
        </div>
    </div>

    <div class="grid" id="board"></div>

    <div style="display: flex; gap: 10px; margin-bottom: 30px;">
        <button class="btn-pro" onclick="openM('shop-m')">üõí SHOP</button>
        <button class="btn-pro" onclick="openM('invite-m')">‚úâÔ∏è INVITE</button>
        <button class="btn-pro" style="color:var(--gold)" onclick="openM('req-m')">üíé REQ</button>
    </div>

    <div id="shop-m" class="modal">
        <div class="modal-content">
            <h2 style="font-family:'Orbitron'; color:var(--blue)">PREMIUM SHOP</h2>
            <div id="shop-items" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; max-height:300px; overflow-y:auto"></div>
            <button class="btn-glow" style="background:none; color:white; border:1px solid #333" onclick="closeM('shop-m')">BACK</button>
        </div>
    </div>

    <div id="invite-m" class="modal">
        <div class="modal-content">
            <h2 style="font-family:'Orbitron'; color:var(--blue)">INVITE FRIENDS</h2>
            <p>Invite via Messenger to get 500 Coins!</p>
            <button class="btn-glow" style="background:#0084ff" onclick="doInvite()">MESSENGER</button>
            <button class="btn-glow" style="background:none; color:white; border:1px solid #333" onclick="closeM('invite-m')">BACK</button>
        </div>
    </div>

    <div id="req-m" class="modal">
        <div class="modal-content">
            <h2 style="font-family:'Orbitron'; color:var(--gold)">COIN REQUEST</h2>
            <input type="number" id="req-val" placeholder="Amount">
            <button class="btn-glow" style="background:var(--gold)" onclick="sendReq()">SEND TO BOSS</button>
            <button class="btn-glow" style="background:none; color:white; border:1px solid #333" onclick="closeM('req-m')">BACK</button>
        </div>
    </div>

    <div id="admin-m" class="modal">
        <div class="modal-content" style="border-color: red;">
            <h2 style="color:red; font-family:'Orbitron'">BOSS PANEL</h2>
            <p style="font-size: 0.7rem; color: #888;">GIFT USER COINS</p>
            <input type="number" id="gift-amt" placeholder="Amount">
            <button class="btn-glow" style="background:red; color:white" onclick="adminGift()">GIFT NOW</button>
            <hr style="border:0.5px solid #222; margin:15px 0">
            <input type="number" id="new-p" placeholder="New Shop Price">
            <button class="btn-glow" onclick="alert('Price updated!')">UPDATE PRICE</button>
            <button class="btn-pro" style="width:100%; margin-top:15px; border:none" onclick="closeM('admin-m')">EXIT</button>
        </div>
    </div>

    <script>
        const BOT_T = "8536299808:AAHJFWEna66RMHZdq-AV20Ak1KOOSwTJT9k";
        const CHAT_I = "7416528268";

        let db = {
            pts: parseInt(localStorage.getItem('sh_pts')) || 2000,
            user: localStorage.getItem('sh_user') || "SIYAMBOSS",
            ico: localStorage.getItem('sh_ico') || '‚öîÔ∏è',
            owned: JSON.parse(localStorage.getItem('sh_owned')) || ['‚öîÔ∏è'],
        };

        const skins = [
            {ico:'‚öîÔ∏è', p:0}, {ico:'ü¶Å', p:500}, {ico:'üêØ', p:1000}, {ico:'ü¶ä', p:2000}, {ico:'üê≤', p:5000}, {ico:'üëë', p:10000}
        ];
        const ais = ['üëª', 'üëΩ', 'üëæ', 'üßü', 'üëπ'];

        let board = Array(25).fill(null);
        let mode = 'easy';
        let turn = 'P1';
        let active = true;

        function init() {
            document.getElementById('u-name').innerText = db.user;
            if(db.user === "SIYAMBOSS") document.getElementById('boss-ui').style.display = 'block';
            updateUI();
            drawBoard();
            drawShop();
        }

        function drawBoard() {
            const b = document.getElementById('board');
            b.innerHTML = '';
            board.forEach((v, i) => {
                const c = document.createElement('div');
                c.className = 'cell';
                c.innerText = v || '';
                c.onclick = () => play(i);
                b.appendChild(c);
            });
        }

        function play(i) {
            if(board[i] || !active) return;
            let bVal = parseInt(document.getElementById('bet').value);
            if(db.pts < bVal) return alert("Not enough coins!");

            board[i] = (turn === 'P1') ? db.ico : '‚≠ï';
            drawBoard();

            if(check(board[i])) return showResult(turn === 'P1' ? 'WIN' : 'LOSS');
            if(board.every(x => x)) return showResult('DRAW');

            if(mode === '2p') {
                turn = (turn === 'P1') ? 'P2' : 'P1';
            } else {
                active = false;
                setTimeout(aiPlay, 600);
            }
        }

        function aiPlay() {
            let aiIco = ais[Math.floor(Math.random()*ais.length)];
            let move = (mode === 'hard') ? getSmart(aiIco, db.ico) : getAny();
            
            if(move !== null) {
                board[move] = aiIco;
                drawBoard();
                if(check(aiIco)) return showResult('LOSS');
            }
            active = true;
        }

        function getSmart(m, o) {
            for(let i=0; i<25; i++) if(!board[i]) { board[i]=m; if(check(m)) { board[i]=null; return i; } board[i]=null; }
            for(let i=0; i<25; i++) if(!board[i]) { board[i]=o; if(check(o)) { board[i]=null; return i; } board[i]=null; }
            return getAny();
        }

        function getAny() {
            let e = board.map((v,i)=>v===null?i:null).filter(v=>v!==null);
            return e[Math.floor(Math.random()*e.length)];
        }

        function check(p) {
            for (let i = 0; i < 25; i++) {
                if (board[i] !== p) continue;
                let r = Math.floor(i / 5), c = i % 5;
                if (c <= 1 && board[i+1]===p && board[i+2]===p && board[i+3]===p) return true;
                if (r <= 1 && board[i+5]===p && board[i+10]===p && board[i+15]===p) return true;
                if (r <= 1 && c <= 1 && board[i+6]===p && board[i+12]===p && board[i+18]===p) return true;
                if (r <= 1 && c >= 3 && board[i+4]===p && board[i+8]===p && board[i+12]===p) return true;
            } return false;
        }

        function showResult(type) {
            let bVal = parseInt(document.getElementById('bet').value);
            const screen = document.getElementById('result-screen');
            const title = document.getElementById('res-title');
            const msg = document.getElementById('res-msg');
            const icon = document.getElementById('res-icon');

            screen.style.display = 'flex';
            if(type === 'WIN') {
                title.innerText = "VICTORY"; title.style.color = var(--blue);
                icon.innerText = "üèÜ"; msg.innerText = "+"+bVal+" COINS";
                db.pts += bVal; confetti();
            } else if(type === 'LOSS') {
                title.innerText = "DEFEAT"; title.style.color = "red";
                icon.innerText = "üíÄ"; msg.innerText = "-"+bVal+" COINS";
                db.pts -= bVal;
                if(db.pts <= 0) tele(`‚ö†Ô∏è *COIN OVER*\nüë§ User: ${db.user}\nBalance is 0!`);
            } else {
                title.innerText = "DRAW"; title.style.color = "gray";
                icon.innerText = "ü§ù"; msg.innerText = "+0 COINS";
            }
            updateUI();
        }

        function closeResult() {
            document.getElementById('result-screen').style.display = 'none';
            board.fill(null); active = true; turn = 'P1'; drawBoard();
        }

        function drawShop() {
            const s = document.getElementById('shop-items'); s.innerHTML = '';
            skins.forEach((x, i) => {
                let isO = db.owned.includes(x.ico);
                s.innerHTML += `<div style="background:#111; padding:10px; border-radius:15px; border:1px solid #222">
                    <div style="font-size:2rem">${x.ico}</div>
                    <div style="font-size:0.7rem; color:var(--gold)">${isO?'OWNED':x.p}</div>
                    <button class="btn-pro" style="width:100%; margin-top:5px" onclick="buy(${i})">${isO?'USE':'BUY'}</button>
                </div>`;
            });
        }

        function buy(i) {
            let item = skins[i];
            if(db.owned.includes(item.ico)) {
                db.ico = item.ico; localStorage.setItem('sh_ico', item.ico); alert("Equipped!");
            } else if(db.pts >= item.p) {
                db.pts -= item.p; db.owned.push(item.ico);
                localStorage.setItem('sh_owned', JSON.stringify(db.owned));
                updateUI(); drawShop();
            }
        }

        function doInvite() {
            window.location.href = "fb-messenger://share/?link=" + encodeURIComponent(window.location.href);
            setTimeout(() => { db.pts += 500; updateUI(); alert("Success! +500 Coins"); }, 2000);
        }

        function sendReq() {
            let val = document.getElementById('req-val').value;
            tele(`üíé *COIN REQUEST*\nüë§ User: ${db.user}\nAmount: ${val}`);
            alert("Request Sent!"); closeM('req-m');
        }

        function adminGift() {
            let val = parseInt(document.getElementById('gift-amt').value);
            db.pts += val; updateUI(); alert("Gift Added!");
        }

        function tele(m) {
            fetch(`https://api.telegram.org/bot${BOT_T}/sendMessage?chat_id=${CHAT_I}&text=${encodeURIComponent(m)}&parse_mode=Markdown`);
        }

        function setMode(m) {
            mode = m; document.querySelectorAll('.btn-pro').forEach(b=>b.classList.remove('active'));
            document.getElementById(m).classList.add('active');
            board.fill(null); drawBoard();
        }

        function updateUI() { document.getElementById('balance').innerText = db.pts; localStorage.setItem('sh_pts', db.pts); }
        function openM(id) { document.getElementById(id).style.display = 'flex'; }
        function closeM(id) { document.getElementById(id).style.display = 'none'; }

        init();
    </script>
</body>
</html>
